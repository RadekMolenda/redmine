<% html_title "#{@version.name} - Task board" -%>

<% content_for :header_tags do %>
  <%= stylesheet_link_tag 'task_board', :plugin => 'redmine_task_board' %>

  <style type="text/css">
    .clearfix:after {
      content: ".";
      display: block;
      height: 0;
      clear: both;
      visibility: hidden;
      }

  .clearfix {display: inline-block;}  /* for IE/Mac */
  </style><!-- main stylesheet ends, CC with new stylesheet below... -->

  <!--[if IE]>
  <style type="text/css">
    .clearfix {
      zoom: 1;     /* triggers hasLayout */
      display: block;     /* resets display for IE/Win */
      }  /* Only IE can see inside the conditional comment
      and read this CSS rule. Don't ever use a normal HTML
      comment inside the CC or it will close prematurely. */
  </style>
  <![endif]-->
  
  <style type="text/css" media="screen">
    .status_container { width: <%= (100/@statuses.size).floor %>%; }
  </style>
<% end %>


<h2><%= @version.name %> Task Board</h2>
<div id="statuses" class="clearfix">
  <% @statuses.each do |status| %>
    <dl id="<%= dom_id(status) %>" class="status_container">
      <dt><%= status.name %></dt>
      <dd>
        <ul id="<%= dom_id(status, 'list') %>">
          <% unless @issues_by_status[status].blank? -%>
            <%= render :partial => 'issue', :collection => @issues_by_status[status] %>
          <% end -%>
        </ul>
      </dd>
    </dl>
    <%= drop_receiving_element(dom_id(status), 
      :accept => status.name.gsub(" ",'').underscore,
      :hoverclass => 'hovered',
      :url => {:controller => 'task_boards', :action => 'update_issue_status'}, 
      :with => "'id=' + (element.id.split('_').last()) + '&status_id=#{status.id}'") %>
  <% end -%>
</div>